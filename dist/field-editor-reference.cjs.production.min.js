"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),n=e(t),r=require("emotion"),i=e(require("@contentful/f36-tokens")),a=require("@contentful/f36-components"),s=require("@contentful/f36-icons"),o=e(require("lodash/get")),c=e(require("moment")),l=require("nanoid"),u=require("@contentful/field-editor-shared"),d=e(require("deep-equal")),f=e(require("constate")),y=e(require("lodash/isNumber")),p=e(require("array-move")),m=require("react-sortable-hoc"),v=e(require("@contentful/mimetype"));function h(e,t,n,r,i,a,s){try{var o=e[a](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,i)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){h(a,r,i,s,o,"next",e)}function o(e){h(a,r,i,s,o,"throw",e)}s(void 0)}))}}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=r.css({display:"flex",border:"1px dashed "+i.gray500,borderRadius:i.borderRadiusMedium,justifyContent:"center",padding:i.spacingXl}),C=r.css({textDecoration:"none",fontWeight:"bold"}),k={"bottom-left":"bottom-start","bottom-right":"bottom-end"},x={wrapper:r.css({position:"relative"}),inputWrapper:r.css({position:"relative",padding:"0 "+i.spacing2Xs}),searchInput:function(e){return r.css({"& > input":{borderColor:"transparent",borderRadius:e?0:void 0,borderLeft:e?"none":void 0,borderRight:e?"none":void 0,paddingRight:i.spacing2Xl,"::placeholder":{color:i.gray600}}})},searchIcon:r.css({position:"absolute",right:i.spacingM,top:i.spacingS,zIndex:Number(i.zIndexDefault),fill:i.gray600}),separator:r.css({background:i.gray200,margin:"10px 0"}),dropdownList:r.css({borderColor:i.gray200})},T=function(e){var r=e.contentTypes,i=e.suggestedContentTypeId,c=e.contentTypesLabel,l=e.onSelect,u=e.testId,d=e.dropdownSettings,f=void 0===d?{position:"bottom-left"}:d,y=e.customDropdownItems,p=e.children,m=t.useState(!1),v=m[0],h=m[1],g=t.useState(!1),E=g[0],b=g[1],C=t.useState(""),T=C[0],I=C[1],A=t.useRef(null),w=t.useRef(null),L=t.useRef(null),M=t.useState(),D=M[0],S=M[1],O=r.length>1||!!y,R=function(){return h(!1)};t.useEffect((function(){v&&setTimeout((function(){var e,t;null==(e=w.current)||null==(t=e.querySelector("input"))||t.focus({preventScroll:!0})}),200)}),[v]),t.useEffect((function(){var e;v&&!D&&S(null==(e=L.current)?void 0:e.clientWidth)}),[v,D]);var j=function(e){R();var t=l(e.sys.id);t&&"function"==typeof t.then&&(b(!0),t.then((function(){return b(!1)}),(function(){return b(!1)})))};t.useEffect((function(){v||I("")}),[v]);var P,N=r.length>20,_=i?300:250,H=r.find((function(e){return e.sys.id===i})),z=r.filter((function(e){return!T||o(e,"name","Untitled").toLowerCase().includes(T.toLowerCase())}));return n.createElement("span",{className:x.wrapper,ref:A,"data-test-id":u},n.createElement(a.Menu,{placement:k[f.position],isAutoalignmentEnabled:f.isAutoalignmentEnabled,isOpen:v,onClose:R,onOpen:function(){O?h(!0):j(r[0])}},n.createElement(a.Menu.Trigger,null,p({isOpen:v,isSelecting:E})),v&&n.createElement(a.Menu.List,{className:x.dropdownList,style:{width:null!=D?D+"px":void 0,maxHeight:_+"px"},ref:L,testId:"add-entry-menu"},Boolean(y)&&n.createElement(n.Fragment,null,y,n.createElement(a.Menu.Divider,null)),N&&n.createElement(n.Fragment,null,n.createElement("div",{ref:w,className:x.inputWrapper},n.createElement(a.TextInput,{className:x.searchInput(O),placeholder:"Search all content types",testId:"add-entry-menu-search",value:T,onChange:function(e){return I(e.target.value)}}),n.createElement(s.SearchIcon,{className:x.searchIcon})),n.createElement(a.Menu.Divider,null)),T&&((P=z.length)?n.createElement(a.Menu.SectionTitle,{testId:"add-entru-menu-search-results"},P," result",P>1?"s":""):null),H&&!T&&n.createElement(n.Fragment,null,n.createElement(a.Menu.SectionTitle,null,"Suggested Content Type"),n.createElement(a.Menu.Item,{testId:"suggested",onClick:function(){return j(H)}},o(H,"name")),n.createElement(a.Menu.Divider,null)),!T&&n.createElement(a.Menu.SectionTitle,null,c),z.length?z.map((function(e,t){return n.createElement(a.Menu.Item,{testId:"contentType",key:o(e,"name")+"-"+t,onClick:function(){return j(e)}},o(e,"name","Untitled"))})):n.createElement(a.Menu.Item,{testId:"add-entru-menu-search-results"},"No results found"))))};T.defaultProps={testId:"create-entry-button-menu-trigger",contentTypesLabel:"All Content Types"};var I={spinnerMargin:r.css({marginRight:i.spacingXs}),action:void 0},A=E({},I,{action:r.css({textDecoration:"none",fontWeight:"bold"})}),w=function(e){var t=e.contentTypes,r=e.onSelect,i=e.customDropdownItems,c=e.text,l=e.testId,u=e.hasPlusIcon,d=void 0!==u&&u,f=e.useExperimentalStyles,y=e.suggestedContentTypeId,p=e.dropdownSettings,m=e.disabled,v=void 0!==m&&m,h=(t=t.sort((function(e,t){return e.name.localeCompare(t.name)}))).find((function(e){return e.sys.id===y})),g=c||"Add "+o(h||(1===t.length?t[0]:{}),"name","entry"),E=t.length>1||i,b=d?n.createElement(s.PlusIcon,null):void 0,C=f?A:I;return n.createElement(T,{contentTypes:t,suggestedContentTypeId:y,contentTypesLabel:f?"New content":void 0,onSelect:r,testId:l,dropdownSettings:p,customDropdownItems:i},(function(e){var t=e.isSelecting;return n.createElement(a.Button,{endIcon:E?n.createElement(s.ChevronDownIcon,null):void 0,variant:"secondary",className:C.action,isDisabled:v||t,startIcon:t?void 0:b,size:"small",testId:"create-entry-link-button",isLoading:t},g)}))},L=r.css({display:"flex",width:"100%",marginTop:i.spacingS}),M=r.css({marginRight:i.spacingXl});function D(){return n.createElement(a.Paragraph,null,"You don't have permission to view this content or this field is not correctly configured. Contact your administrator for help.")}var S={createNew:function(e){return null!=e&&e.contentType?"Create new "+e.contentType+" and link":"Create new entry and link"},linkExisting:function(e){return null!=e&&e.canLinkMultiple?"Link existing entries":"Link existing entry"}},O={createNew:function(){return"Create new asset and link"},linkExisting:function(e){return null!=e&&e.canLinkMultiple?"Link existing assets":"Link existing asset"}},R={dropdown:"linkEditor.dropdown",createAndLink:"linkEditor.createAndLink",createAndLinkWrapper:"create-entry-button-menu-trigger",linkExisting:"linkEditor.linkExisting"};function j(e){if(e.isFull)return null;var n=E({},"Entry"===e.entityType?S:O,e.actionLabels);return t.createElement("div",{className:L},e.canCreateEntity&&t.createElement(t.Fragment,null,"Entry"===e.entityType&&t.createElement(w,{testId:R.createAndLink,disabled:e.isDisabled,text:n.createNew({contentType:1===e.contentTypes.length?e.contentTypes[0].name:void 0}),contentTypes:e.contentTypes,hasPlusIcon:!0,onSelect:function(t){return t?e.onCreate(t,e.itemsLength):Promise.resolve()}}),"Asset"===e.entityType&&t.createElement(a.Button,{isDisabled:e.isDisabled,testId:R.createAndLink,onClick:function(){e.onCreate(void 0,e.itemsLength)},variant:"secondary",startIcon:t.createElement(s.PlusIcon,null),size:"small"},n.createNew()),t.createElement("span",{className:M})),e.canLinkEntity&&t.createElement(a.Button,{isDisabled:e.isDisabled,testId:R.linkExisting,onClick:function(){e.onLinkExisting()},variant:"secondary",startIcon:t.createElement(s.LinkIcon,null),size:"small"},n.linkExisting({canLinkMultiple:e.canLinkMultiple})),!e.canCreateEntity&&!e.canLinkEntity&&t.createElement(D,null))}var P=E({},R,{actionsWrapper:"link-actions-menu-trigger"});function N(e){return e.canCreateEntity?t.createElement(w,{testId:P.actionsWrapper,disabled:e.isDisabled,text:e.combinedActionsLabel||"Add content",contentTypes:e.contentTypes,hasPlusIcon:!0,useExperimentalStyles:!0,dropdownSettings:{position:"bottom-left"},onSelect:function(t){return t?e.onCreate(t):Promise.resolve()},customDropdownItems:e.canLinkEntity?t.createElement(a.Menu.Item,{testId:P.linkExisting,onClick:function(){e.onLinkExisting()}},"Add existing content"):void 0}):e.canLinkEntity?t.createElement(a.Button,{isDisabled:e.isDisabled,testId:P.linkExisting,className:C,onClick:function(){e.onLinkExisting()},variant:"secondary",startIcon:t.createElement(s.LinkIcon,null),size:"small"},"Add existing content"):null}function _(e){var n=t.useState(!1),r=n[0],i=n[1];return e.canLinkEntity&&e.canCreateEntity?t.createElement(a.Menu,{isOpen:r,onClose:function(){i(!1)},onOpen:function(){i(!0)}},t.createElement(a.Menu.Trigger,null,t.createElement(a.Button,{endIcon:t.createElement(s.ChevronDownIcon,null),isDisabled:e.isDisabled,testId:P.actionsWrapper,className:C,variant:"secondary",startIcon:t.createElement(s.PlusIcon,null),size:"small"},"Add media")),r&&t.createElement(a.Menu.List,{testId:P.dropdown},t.createElement(a.Menu.Item,{testId:P.linkExisting,onClick:function(){e.onLinkExisting()}},"Add existing media"),t.createElement(a.Menu.Item,{testId:P.createAndLink,onClick:function(){e.onCreate()}},"Add new media"))):e.canLinkEntity?t.createElement(a.Button,{isDisabled:e.isDisabled,testId:P.linkExisting,className:C,onClick:function(){e.onLinkExisting()},variant:"secondary",startIcon:t.createElement(s.PlusIcon,null),size:"small"},"Add existing media"):e.canCreateEntity?t.createElement(a.Button,{isDisabled:e.isDisabled,testId:P.createAndLink,className:C,onClick:function(){e.onCreate()},variant:"secondary",startIcon:t.createElement(s.PlusIcon,null),size:"small"},"Add media"):null}var H=r.css({position:"relative"}),z=r.css({display:"flex",alignItems:"center",width:"135px",height:"160px",textAlign:"center"}),F=r.css({position:"absolute",top:i.spacingS,right:i.spacingS});function B(e){return n.createElement(a.Card,{className:H},n.createElement("div",{className:e.asSquare?z:""},n.createElement(a.SectionHeading,{marginBottom:"none"},"Entry"===e.entityType&&"Entry is missing or inaccessible","Asset"===e.entityType&&"Asset is missing or inaccessible")),!e.isDisabled&&e.onRemove&&n.createElement(a.IconButton,{variant:"transparent",icon:n.createElement(s.CloseIcon,{variant:"muted"}),className:F,"aria-label":"Delete",onClick:function(){e.onRemove&&e.onRemove()}}))}function q(e,t){return e(t={exports:{}},t.exports),t.exports}var Y=q((function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=Object.create((t&&t.prototype instanceof d?t:d).prototype),a=new x(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var o=b(s,n);if(o){if(o===u)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function d(){}function f(){}function y(){}var p={};p[i]=function(){return this};var m=Object.getPrototypeOf,v=m&&m(m(T([])));v&&v!==t&&n.call(v,i)&&(p=v);var h=y.prototype=d.prototype=Object.create(p);function g(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){var r;this._invoke=function(i,a){function s(){return new t((function(r,s){!function r(i,a,s,o){var c=l(e[i],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,o)}))}o(c.arg)}(i,a,r,s)}))}return r=r?r.then(s,s):s()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function T(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:I}}function I(){return{value:void 0,done:!0}}return f.prototype=h.constructor=y,y.constructor=f,f.displayName=o(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,o(e,s,"GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},g(E.prototype),E.prototype[a]=function(){return this},e.AsyncIterator=E,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var s=new E(c(t,n,r,i),a);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},g(h),o(h,s,"Generator"),h[i]=function(){return this},h.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var o=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(o&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}})),U=function(e){return e.map((function(e){return e.sys.id}))};function G(e){return V.apply(this,arguments)}function V(){return(V=g(Y.mark((function e(t){var n,r;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Entry"!==t.entityType){e.next=11;break}if(t.contentTypeId){e.next=3;break}return e.abrupt("return",{});case 3:return e.next=5,t.sdk.navigator.openNewEntry(t.contentTypeId,{slideIn:!0});case 5:return e.abrupt("return",{entity:(n=e.sent).entity,slide:n.slide});case 11:return e.next=13,t.sdk.navigator.openNewAsset({slideIn:!0});case 13:return e.abrupt("return",{entity:(r=e.sent).entity,slide:r.slide});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return X.apply(this,arguments)}function X(){return(X=g(Y.mark((function e(t){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Entry"!==t.entityType){e.next=6;break}return e.next=3,t.sdk.dialogs.selectSingleEntry({locale:t.sdk.field.locale,contentTypes:U(t.editorPermissions.readableContentTypes)});case 3:return e.abrupt("return",e.sent);case 6:return e.abrupt("return",t.sdk.dialogs.selectSingleAsset({locale:t.sdk.field.locale,mimetypeGroups:t.editorPermissions.validations.mimetypeGroups}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return K.apply(this,arguments)}function K(){return(K=g(Y.mark((function e(t){var n,r,i,a,s,o;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.sdk.field.getValue(),a=Array.isArray(i)?i.length:i?1:0,s=Math.max(((null==(n=t.editorPermissions.validations.numberOfLinks)?void 0:n.min)||1)-a,1),o=((null==(r=t.editorPermissions.validations.numberOfLinks)?void 0:r.max)||Infinity)-a,"Entry"!==t.entityType){e.next=10;break}return e.next=7,t.sdk.dialogs.selectMultipleEntries({locale:t.sdk.field.locale,contentTypes:U(t.editorPermissions.readableContentTypes),min:s,max:o});case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",t.sdk.dialogs.selectMultipleAssets({locale:t.sdk.field.locale,mimetypeGroups:t.editorPermissions.validations.mimetypeGroups,min:s,max:o}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=["renderCustomActions"];function Z(e){var n,r=e.sdk,i=e.editorPermissions,a=e.entityType,s=e.canLinkMultiple,o=e.isDisabled,c=e.actionLabels,l=e.itemsLength,u=null==(n=i.validations.numberOfLinks)?void 0:n.max,d=r.field.getValue(),f=Array.isArray(d)?d.length:d?1:0,y=!!u&&u<=f,p=0===f,m=t.useCallback((function(t,n,r){void 0===n&&(n=l),e.onCreate(t.sys.id,n),e.onAction&&e.onAction({type:"create_and_link",entity:a,entityData:t,slide:r,index:n})}),[a,e.onCreate,e.onAction]),v=t.useCallback((function(t,n){void 0===n&&(n=l),e.onLink(t.map((function(e){return e.sys.id})),n),t.forEach((function(t,r){e.onAction&&e.onAction({type:"select_and_link",entity:a,entityData:t,index:void 0===n?void 0:n+r})}))}),[a,e.onLink,e.onAction]),h=t.useCallback(function(){var e=g(Y.mark((function e(t,n){var i,s,o;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G({sdk:r,entityType:a,contentTypeId:t});case 2:if(o=(i=e.sent).slide,s=i.entity){e.next=7;break}return e.abrupt("return");case 7:m(s,n,o);case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[r,a,m]),E=function(){var e=g(Y.mark((function e(t){var n;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W({sdk:r,entityType:a,editorPermissions:i});case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:v([n],t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=g(Y.mark((function e(t){var n;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J({sdk:r,entityType:a,editorPermissions:i});case 2:if((n=e.sent)&&0!==n.length){e.next=5;break}return e.abrupt("return");case 5:v(n,t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t.useMemo((function(){return{entityType:a,canLinkMultiple:s,isDisabled:o,isEmpty:p,isFull:y,canCreateEntity:i.canCreateEntity,canLinkEntity:i.canLinkEntity,contentTypes:i.creatableContentTypes,onCreate:h,onLinkExisting:s?b:E,actionLabels:c,onCreated:m,onLinkedExisting:v,itemsLength:l}}),[a,s,o,p,y,i.canCreateEntity,i.canLinkEntity,c,i.creatableContentTypes.map((function(e){return e.sys.id})).join(":"),h,E,b,m,v,l])}function $(e){return(e.renderCustomActions||function(e){return t.createElement(j,Object.assign({},e))})(function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(i[n]=e[n]);return i}(e,Q))}var ee=function(e){var t,n=e.job,r=e.jobsCount;return"Will "+n.action.toLowerCase()+" "+(t=n.scheduledFor.datetime,function(e,t){switch(c().startOf("day").diff(c(e).startOf("day"),"days")){case 0:return"Today, "+c(e).format("DD MMM YYYY");case-1:return"Tomorrow, "+c(e).format("DD MMM YYYY");case 1:return"Yesterday, "+c(e).format("DD MMM YYYY");default:return c(e).format("ddd, DD MMM YYYY")}}(t)+" at "+function(e){return c.utc(e).local().format("h:mm A")}(t)).toLowerCase()+"\n  "+(r>1&&"+ "+(r-1)+" more")},te=function(e){var t=e.job,r=e.children;return n.createElement(a.Tooltip,{placement:"top",testId:t.sys.id,as:"div",content:ee({job:t,jobsCount:e.jobsCount})},r)},ne=function(e){var t=e.entityType,r=e.entityId,i=e.getEntityScheduledActions,a=e.children,s=n.useState({type:"loading"}),o=s[0],c=s[1];if(n.useEffect((function(){i(t,r).then((function(e){c({type:"loaded",jobs:e})})).catch((function(e){c({type:"error",error:e})}))}),[]),"loading"===o.type||"error"===o.type)return null;var l=o.jobs?o.jobs:[];return 0===l.length?null:n.createElement(te,{job:l[0],jobsCount:l.length},a)};function re(e){return n.createElement("img",{alt:e.file.fileName,src:e.file.url+"?w=70&h=70&fit=thumb",height:70,width:70})}function ie(e){var t=e.audiences,r={audienceContainer:{borderTopColor:i.gray200,borderTopWidth:1,borderTopStyle:"solid",paddingTop:i.spacingXs,width:"calc(100% + "+i.spacingM+" * 2)",marginLeft:"-"+i.spacingM,paddingLeft:i.spacingM,paddingRight:i.spacingM,marginBottom:"-"+i.spacingXs},badge:{textTransform:"none",marginLeft:i.spacingS,letterSpacing:0}};return t&&t.length?n.createElement(a.Flex,{style:r.audienceContainer},n.createElement(a.Flex,{flexGrow:1},n.createElement(a.Text,{fontColor:"gray600"},"Audience")),t.map((function(e){return n.createElement(a.Badge,{key:l.nanoid(),style:r.badge},e)}))):null}function ae(e,t){var n,r,i,a,s;switch(t.type){case"set_entry":return E({},e,{entries:E({},e.entries,(n={},n[t.id]=t.entry,n))});case"set_entry_failed":return E({},e,{entries:E({},e.entries,(r={},r[t.id]="failed",r))});case"set_asset":return E({},e,{assets:E({},e.assets,(i={},i[t.id]=t.asset,i))});case"set_asset_failed":return E({},e,{assets:E({},e.assets,(a={},a[t.id]="failed",a))});case"set_scheduled_actions":return E({},e,{scheduledActions:E({},e.scheduledActions,(s={},s[t.key]=t.actions,s))});default:return e}}var se={entries:{},assets:{},scheduledActions:{}};function oe(e){var n=t.useReducer(ae,se),r=n[0],i=n[1],a=t.useCallback((function(t,n){var a=t+":"+n;return r.scheduledActions[a]?Promise.resolve(r.scheduledActions[a]):e.sdk.space.getEntityScheduledActions(t,n).then((function(e){return i({type:"set_scheduled_actions",key:a,actions:e}),e})).catch((function(){return i({type:"set_scheduled_actions",key:a,actions:void 0}),[]}))}),[e.sdk.space,r.scheduledActions]),s=t.useCallback((function(t){return e.sdk.space.getEntry(t).then((function(e){return i({type:"set_entry",id:t,entry:e}),e})).catch((function(){i({type:"set_entry_failed",id:t})}))}),[e.sdk.space]),o=t.useCallback((function(t){return e.sdk.space.getAsset(t).then((function(e){return i({type:"set_asset",id:t,asset:e}),e})).catch((function(){i({type:"set_asset_failed",id:t})}))}),[e.sdk.space]),c=t.useCallback((function(e){return r.assets[e]&&"failed"!==r.assets[e]?Promise.resolve(r.assets[e]):o(e)}),[r.assets,o]),l=t.useCallback((function(e){return r.entries[e]&&"failed"!==r.entries[e]?Promise.resolve(r.entries[e]):s(e)}),[r.entries,s]);return t.useEffect((function(){if(void 0!==e.sdk.space.onEntityChanged){var t=e.sdk.space.onEntityChanged,n=[];return Object.keys(r.entries).forEach((function(e){r.entries[e]&&"failed"!==r.entries.id&&n.push(t("Entry",e,(function(t){return i({type:"set_entry",id:e,entry:t})})))})),Object.keys(r.assets).forEach((function(e){r.assets[e]&&"failed"!==r.assets.id&&n.push(t("Asset",e,(function(t){return i({type:"set_asset",id:e,asset:t})})))})),function(){return n.forEach((function(e){return e()}))}}return e.sdk.navigator.onSlideInNavigation((function(e){e.oldSlideLevel>e.newSlideLevel&&(Object.keys(r.entries).map((function(e){r.entries[e]&&"failed"!==r.entries[e]&&s(e)})),Object.keys(r.assets).map((function(e){r.assets[e]&&"failed"!==r.assets[e]&&o(e)})))}))}),[e.sdk,r.assets,r.entries]),E({getOrLoadEntry:l,getOrLoadAsset:c,loadEntityScheduledActions:a},r)}var ce=f(oe),le=ce[0],ue=ce[1];function de(e){return t.createElement(le,{sdk:e.sdk},t.createElement(u.FieldConnector,{throttle:0,field:e.sdk.field,isInitiallyDisabled:e.isInitiallyDisabled,isEqualValues:function(e,t){return d(e,t)}},e.children))}de.defaultProps={isInitiallyDisabled:!0,hasCardEditActions:!0};var fe=function(){return Promise.resolve(!0)};function ye(e){var t;return{canPerformAction:e.can,canPerformActionOnEntryOfType:null!=(t=e.canPerformActionOnEntryOfType)?t:fe}}function pe(){return(pe=g(Y.mark((function e(t,n){var r;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Symbol(),e.next=3,Promise.all(t.map(function(){var e=g(Y.mark((function e(t){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t);case 2:if(!e.sent){e.next=6;break}e.t0=t,e.next=7;break;case 6:e.t0=r;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.abrupt("return",e.sent.filter((function(e){return e!==r})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e){var n=e.sdk,r=e.entityType,i=e.parameters,a=t.useMemo((function(){return function(e){var t,n,r,i,a=[].concat(e.validations,null!=(t=null==(n=e.items)?void 0:n.validations)?t:[]),s=a.find((function(e){return"linkContentType"in e})),o=a.find((function(e){return"linkMimetypeGroup"in e})),c=a.find((function(e){return"size"in e})),l=c&&c.size||{},u=l.min,d=l.max,f=void 0;return y(u)&&y(d)?f={type:"min-max",min:u,max:d}:y(u)?f={type:"min",min:u,max:void 0}:y(d)&&(f={type:"max",max:d,min:void 0}),{contentTypes:null!=(r=null==s?void 0:s.linkContentType)?r:void 0,mimetypeGroups:null!=(i=null==o?void 0:o.linkMimetypeGroup)?i:void 0,numberOfLinks:f}}(e.sdk.field)}),[e.sdk.field]),s=t.useState(!0),o=s[0],c=s[1],l=t.useState(!0),u=l[0],d=l[1],f=function(e){var n=t.useMemo((function(){return"Asset"===e.entityType?[]:e.validations.contentTypes?e.allContentTypes.filter((function(t){var n;return null==(n=e.validations.contentTypes)?void 0:n.includes(t.sys.id)})):e.allContentTypes}),[e.allContentTypes,e.validations.contentTypes,e.entityType]),r=t.useState(n),i=r[0],a=r[1],s=t.useState(n),o=s[0],c=s[1],l=ye(e.sdk.access).canPerformActionOnEntryOfType;return t.useEffect((function(){function e(e){return function(e,t){return pe.apply(this,arguments)}(n,(function(t){return l(e,t.sys.id)}))}function t(){return(t=g(Y.mark((function t(){var n,r;return Y.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e("create");case 2:return n=t.sent,t.next=5,e("read");case 5:r=t.sent,a(n),c(r);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[n]),{creatableContentTypes:i,readableContentTypes:o,availableContentTypes:n}}(E({},e,{validations:a})),p=f.creatableContentTypes,m=f.readableContentTypes,v=f.availableContentTypes,h=ye(n.access).canPerformAction;return t.useEffect((function(){function e(){return(e=g(Y.mark((function e(){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Asset"!==r){e.next=8;break}return e.next=3,h("create","Asset");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=!0;case 6:c(e.t0);case 8:"Entry"===r&&c(p.length>0||!0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!1!==i.instance.showCreateEntityAction?function(){e.apply(this,arguments)}():c(!1)}),[r,i.instance,p]),t.useEffect((function(){function e(){return(e=g(Y.mark((function e(){return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Asset"!==r){e.next=8;break}return e.next=3,h("read","Asset");case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=!0;case 6:d(e.t0);case 8:"Entry"===r&&d(!0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!1!==i.instance.showLinkEntityAction?function(){e.apply(this,arguments)}():d(!1)}),[r,i.instance,m]),{canCreateEntity:o,canLinkEntity:u,creatableContentTypes:p,readableContentTypes:m,availableContentTypes:v,validations:a}}function ve(e){var n=e.setValue,r=e.entityType,i=me(e),a=t.useCallback((function(e){n({sys:{type:"Link",linkType:r,id:e}})}),[n,r]),s=t.useCallback((function(e){n({sys:{type:"Link",linkType:r,id:e[0]}})}),[n,r]),o=Z(E({},e,{canLinkMultiple:!1,editorPermissions:i,onCreate:a,onLink:s})),c=t.useCallback((function(t,n,r){return!!e.renderCustomCard&&e.renderCustomCard(t,o,r)}),[o]);return e.entityId?e.children(E({},e,{renderCustomCard:e.renderCustomCard&&c})):t.createElement($,Object.assign({renderCustomActions:e.renderCustomActions},o))}function he(e){var n=e.sdk.space.getCachedContentTypes();return t.createElement(de,Object.assign({},e),(function(r){var i=r.value;return t.createElement(ve,Object.assign({},e,{key:r.externalReset+"-reference",entityId:i?i.sys.id:"",isDisabled:r.disabled,setValue:r.setValue,allContentTypes:n}))}))}he.defaultProps={hasCardEditActions:!0,hasCardRemoveActions:!0};var ge=u.entityHelpers.getEntryTitle,Ee=u.entityHelpers.getEntityDescription,be=u.entityHelpers.getEntryStatus,Ce=u.entityHelpers.getEntryImage,ke={scheduleIcon:r.css({marginRight:i.spacing2Xs})};function xe(e){var n,r,i,o=t.useState(null),c=o[0],l=o[1],d=e.contentType;t.useEffect((function(){e.entry&&Ce({entry:e.entry,contentType:d,localeCode:e.localeCode,defaultLocaleCode:e.defaultLocaleCode},e.getAsset).then((function(e){l(e)})).catch((function(){l(null)}))}),[e.entry,e.getAsset,d,e.localeCode,e.defaultLocaleCode]);var f=be(null==(n=e.entry)?void 0:n.sys);if("deleted"===f)return t.createElement(B,{entityType:"Entry",isDisabled:e.isDisabled,onRemove:e.onRemove});var y=ge({entry:e.entry,contentType:d,localeCode:e.localeCode,defaultLocaleCode:e.defaultLocaleCode,defaultTitle:"Untitled"}),p=Ee({entity:e.entry,contentType:d,localeCode:e.localeCode,defaultLocaleCode:e.defaultLocaleCode}),m=null==(r=e.entry.fields)||null==(i=r.audience)?void 0:i[e.localeCode];return Array.isArray(m)&&m.sort(),t.createElement(a.EntryCard,{as:e.entryUrl?"a":"article",href:e.entryUrl,title:y,description:p,contentType:null==d?void 0:d.name,size:e.size,isSelected:e.isSelected,status:f,icon:t.createElement(ne,{getEntityScheduledActions:e.getEntityScheduledActions,entityType:"Entry",entityId:e.entry.sys.id},t.createElement(s.ClockIcon,{className:ke.scheduleIcon,size:"small",variant:"muted",testId:"schedule-icon"})),thumbnailElement:c&&u.isValidImage(c)?t.createElement(re,{file:c}):void 0,dragHandleRender:e.renderDragHandle,withDragHandle:!!e.renderDragHandle,actions:e.onEdit||e.onRemove?[e.hasCardEditActions&&e.onEdit?t.createElement(a.MenuItem,{key:"edit",testId:"edit",onClick:function(){e.onEdit&&e.onEdit()}},"Edit"):null,e.hasCardRemoveActions&&e.onRemove?t.createElement(a.MenuItem,{key:"delete",testId:"delete",onClick:function(){e.onRemove&&e.onRemove()}},"Remove"):null,e.hasCardMoveActions&&(e.onMoveTop||e.onMoveBottom)?t.createElement(a.MenuDivider,null):null,e.hasCardMoveActions&&e.onMoveTop?t.createElement(a.MenuItem,{onClick:function(){return e.onMoveTop&&e.onMoveTop()},testId:"move-top"},"Move to top"):null,e.hasCardMoveActions&&e.onMoveBottom?t.createElement(a.MenuItem,{onClick:function(){return e.onMoveBottom&&e.onMoveBottom()},testId:"move-bottom"},"Move to bottom"):null].filter((function(e){return e})):[],onClick:e.isClickable?function(t){if(t.preventDefault(),e.onClick)return e.onClick(t);e.onEdit&&e.onEdit()}:void 0},t.createElement(ie,{audiences:m}))}function Te(e,t,n){return Ie.apply(this,arguments)}function Ie(){return(Ie=g(Y.mark((function e(t,n,r){var i;return Y.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.bulkEditing){e.next=11;break}return e.prev=1,e.next=4,t.navigator.openBulkEditor(t.entry.getSys().id,{fieldId:t.field.id,locale:t.field.locale,index:null!=(i=r.index)?i:0});case 4:return e.abrupt("return",e.sent.slide);case 9:e.prev=9,e.t0=e.catch(1);case 11:return e.next=13,t.navigator.openEntry(n,{slideIn:!0});case 13:return e.abrupt("return",e.sent.slide);case 16:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function Ae(e){var n=ue(),r=n.getOrLoadEntry,i=n.getOrLoadAsset,s=n.loadEntityScheduledActions,c=n.entries;t.useEffect((function(){r(e.entryId)}),[e.entryId]);var l="link"===e.viewType?"small":"default",u=c[e.entryId],d="failed"===u?"failed":void 0===u?"undefined":":"+u.sys.id+":"+u.sys.version,f=function(){var t=g(Y.mark((function t(){var n;return Y.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Te(e.sdk,e.entryId,{bulkEditing:e.parameters.instance.bulkEditing,index:e.index});case 2:n=t.sent,e.onAction&&e.onAction({entity:"Entry",type:"edit",id:e.entryId,contentTypeId:o(u,"sys.contentType.sys.id"),slide:n});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){e.onRemove(),e.onAction&&e.onAction({entity:"Entry",type:"delete",id:e.entryId,contentTypeId:o(u,"sys.contentType.sys.id")})};return t.useEffect((function(){u&&e.onAction&&e.onAction({type:"rendered",entity:"Entry"})}),[u]),t.useMemo((function(){if("failed"===u){var n=t.createElement(B,{entityType:"Entry",isDisabled:e.isDisabled,onRemove:y});return e.renderCustomMissingEntityCard?e.renderCustomMissingEntityCard({defaultCard:n,entity:{id:e.entryId,type:"Entry"}}):n}if(void 0===u)return t.createElement(a.EntryCard,{size:l,isLoading:!0});var r={index:e.index,entity:u,entityUrl:e.getEntityUrl&&e.getEntityUrl(u.sys.id),contentType:e.allContentTypes.find((function(e){return e.sys.id===u.sys.contentType.sys.id})),isDisabled:e.isDisabled,size:l,localeCode:e.sdk.field.locale,defaultLocaleCode:e.sdk.locales.default,renderDragHandle:e.renderDragHandle,onEdit:f,onRemove:y,onMoveTop:e.onMoveTop,onMoveBottom:e.onMoveBottom},o=e.hasCardEditActions,c=e.hasCardMoveActions,d=e.hasCardRemoveActions;function p(e){var n=E({},r,e,{hasCardEditActions:o,hasCardMoveActions:c,hasCardRemoveActions:d,getAsset:i,getEntityScheduledActions:s,entry:(null==e?void 0:e.entity)||r.entity,entryUrl:(null==e?void 0:e.entityUrl)||r.entityUrl});return t.createElement(xe,Object.assign({},n))}if(e.renderCustomCard){var m=e.renderCustomCard(r,{},p);if(!1!==m)return m}return p()}),[e,d])}function we(e){return t.createElement(he,Object.assign({},e,{entityType:"Entry"}),(function(n){var r=n.setValue;return t.createElement(Ae,Object.assign({},e,{allContentTypes:n.allContentTypes,isDisabled:n.isDisabled,entryId:n.entityId,renderCustomCard:n.renderCustomCard,hasCardEditActions:n.hasCardEditActions,hasCardRemoveActions:n.hasCardRemoveActions,onRemove:function(){r(null)}}))}))}function Le(e,t,n,r,i){void 0===i&&(i=n.length);var a=r.map((function(e){return{sys:{type:"Link",linkType:t,id:e}}})),s=Array.from(n);s.splice.apply(s,[i,0].concat(a)),e(s)}xe.defaultProps={isClickable:!0,hasCardEditActions:!0,hasCardMoveActions:!0,hasCardRemoveActions:!0},we.defaultProps={isInitiallyDisabled:!0};var Me=[],De={sys:{id:"null-value"}};function Se(e){var n=e.setValue,r=e.entityType,i=me(e),a=t.useMemo((function(){return(e.items||[]).map((function(e){return e||De}))}),[e.items]),s=t.useCallback((function(e,t){return t.preventDefault()}),[]),o=t.useCallback((function(e){var t=p(a,e.oldIndex,e.newIndex);n(t)}),[a,n]),c=t.useCallback((function(e,t){var r=p(a,e,t);n(r)}),[a,n]),l=t.useCallback((function(e,t){return Le(n,r,a,[e],t)}),[n,a,r]),u=t.useCallback((function(e,t){return Le(n,r,a,e,t)}),[n,a,r]),d=Z(E({},e,{canLinkMultiple:!0,editorPermissions:i,onCreate:l,onLink:u,itemsLength:a.length})),f=t.useCallback((function(t,n,r){return!!e.renderCustomCard&&e.renderCustomCard(t,d,r)}),[d]);return t.createElement(t.Fragment,null,e.children(E({},e,{onSortStart:s,onSortEnd:o,onMove:c,renderCustomCard:e.renderCustomCard&&f})),t.createElement($,Object.assign({renderCustomActions:e.renderCustomActions},d)))}function Oe(e){var n=e.sdk.space.getCachedContentTypes();return t.createElement(de,Object.assign({},e),(function(r){return t.createElement(Se,Object.assign({},e,{items:r.value||Me,isDisabled:r.disabled,setValue:r.setValue,key:r.externalReset+"-list",allContentTypes:n}))}))}Oe.defaultProps={hasCardEditActions:!0};var Re={containter:r.css({position:"relative"}),item:r.css({marginBottom:i.spacingM})},je=function(e){var t=m.SortableHandle((function(){return e.drag}));return n.createElement(t,null)},Pe=m.SortableElement((function(e){return n.createElement("div",{className:Re.item},e.children)})),Ne=m.SortableContainer((function(e){var t=e.items.length-1;return n.createElement("div",{className:Re.containter},e.items.map((function(r,i){return n.createElement(Pe,{disabled:e.isDisabled,key:r.sys.id+"-"+i,index:i},n.createElement(Ae,Object.assign({},e,{key:r.sys.id+"-"+i,index:i,allContentTypes:e.allContentTypes,isDisabled:e.isDisabled,entryId:r.sys.id,onRemove:function(){e.setValue(e.items.filter((function(e,t){return t!==i})))},onMoveTop:0!==i?function(){return e.onMove(i,0)}:void 0,onMoveBottom:i!==t?function(){return e.onMove(i,t)}:void 0,renderDragHandle:e.isDisabled?void 0:je})))})))}));function _e(e){var t=e.entityFile,r=o(t,"fileName"),i=o(t,"contentType"),s=o(t,"details.size"),c=o(t,"details.image");return[n.createElement(a.Menu.SectionTitle,{key:"file-section"},"File info"),r&&n.createElement(a.Menu.Item,{key:"file-name"},n.createElement(a.Text,{isTruncated:!0},r)),i&&n.createElement(a.Menu.Item,{key:"file-type"},n.createElement(a.Text,{isTruncated:!0},i)),s&&n.createElement(a.Menu.Item,{key:"file-size"},u.shortenStorageUnit(s,"B")),c&&n.createElement(a.Menu.Item,{key:"file-dimentions"},c.width+" Ã— "+c.height)].filter((function(e){return e}))}function He(e){var t=e.entityFile,r=e.isDisabled,i=e.onEdit,s=e.onRemove;return[n.createElement(a.Menu.SectionTitle,{key:"section-title"},"Actions"),i?n.createElement(a.Menu.Item,{key:"edit",onClick:i,testId:"card-action-edit"},"Edit"):null,t?n.createElement(a.Menu.Item,{key:"download",onClick:function(){"string"==typeof t.url&&window.open(t.url,"_blank","noopener,noreferrer")},testId:"card-action-download"},"Download"):null,s?n.createElement(a.Menu.Item,{key:"remove",disabled:r,onClick:s,testId:"card-action-remove"},"Remove"):null].filter((function(e){return e}))}var ze={image:"image",video:"video",audio:"audio",richtext:"richtext",presentation:"presentation",spreadsheet:"spreadsheet",pdfdocument:"pdf",archive:"archive",plaintext:"plaintext",code:"code",markup:"markup"},Fe={scheduleIcon:r.css({marginRight:i.spacing2Xs})};function Be(e){if(!e)return"archive";var t=v.getGroupLabel({type:e.contentType,fallbackFileName:e.fileName});return ze[t]||"archive"}var qe=function(e){var t=e.className,r=e.onEdit,i=e.getAssetUrl,o=e.onRemove,c=e.size,l=e.isDisabled,d=e.isSelected,f=e.isClickable,y=u.entityHelpers.getEntryStatus(e.asset.sys);if("deleted"===y)return n.createElement(B,{entityType:"Asset",asSquare:!0,isDisabled:e.isDisabled,onRemove:e.onRemove});var p=u.entityHelpers.getAssetTitle({asset:e.asset,localeCode:e.localeCode,defaultLocaleCode:e.defaultLocaleCode,defaultTitle:"Untitled"}),m=e.asset.fields.file?e.asset.fields.file[e.localeCode]||e.asset.fields.file[e.defaultLocaleCode]:void 0,v=i?i(e.asset.sys.id):void 0;return n.createElement(a.AssetCard,{as:v?"a":"article",type:Be(m),title:p,className:t,isSelected:d,href:v,status:y,icon:n.createElement(ne,{getEntityScheduledActions:e.getEntityScheduledActions,entityType:"Asset",entityId:e.asset.sys.id},n.createElement(s.ClockIcon,{className:Fe.scheduleIcon,size:"small",variant:"muted",testId:"schedule-icon"})),src:m&&m.url?"small"===c?m.url+"?w=150&h=150&fit=thumb":m.url+"?h=300":"",onClick:f?function(e){e.preventDefault(),r&&r()}:void 0,dragHandleRender:e.renderDragHandle,withDragHandle:!!e.renderDragHandle,actions:[].concat(He({entityFile:m,isDisabled:l,onEdit:r,onRemove:o}),m?_e({entityFile:m}):[]).filter((function(e){return e})),size:c})};qe.defaultProps={isClickable:!0};var Ye={scheduleIcon:r.css({marginRight:i.spacing2Xs})},Ue=function(e){var t=e.className,r=e.href,i=e.onEdit,o=e.onRemove,c=e.isDisabled,l=u.entityHelpers.getEntryStatus(e.asset.sys);if("deleted"===l)return n.createElement(B,{entityType:"Asset",isDisabled:e.isDisabled,onRemove:e.onRemove});var d=u.entityHelpers.getAssetTitle({asset:e.asset,localeCode:e.localeCode,defaultLocaleCode:e.defaultLocaleCode,defaultTitle:"Untitled"}),f=e.asset.fields.file?e.asset.fields.file[e.localeCode]||e.asset.fields.file[e.defaultLocaleCode]:void 0;return n.createElement(a.EntryCard,{as:r?"a":"article",contentType:"Asset",title:d,className:t,href:r,size:"small",status:l,thumbnailElement:f&&u.isValidImage(f)?n.createElement(re,{file:f}):void 0,icon:n.createElement(ne,{getEntityScheduledActions:e.getEntityScheduledActions,entityType:"Asset",entityId:e.asset.sys.id},n.createElement(s.ClockIcon,{className:Ye.scheduleIcon,size:"small",variant:"muted",testId:"schedule-icon"})),onClick:function(e){e.preventDefault(),i()},dragHandleRender:e.renderDragHandle,withDragHandle:!!e.renderDragHandle,actions:[He({entityFile:f,isDisabled:c,onEdit:i,onRemove:o}),f?_e({entityFile:f}):null].filter((function(e){return e}))})};function Ge(e){var n=ue(),r=n.getOrLoadAsset,i=n.loadEntityScheduledActions,s=n.assets;t.useEffect((function(){r(e.assetId)}),[e.assetId]);var o=s[e.assetId],c="failed"===o?"failed":void 0===o?"undefined":":"+o.sys.id+":"+o.sys.version;t.useEffect((function(){o&&e.onAction&&e.onAction({type:"rendered",entity:"Asset"})}),[o]);var l=function(){var t=g(Y.mark((function t(){var n;return Y.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.sdk.navigator.openAsset(e.assetId,{slideIn:!0});case 2:n=t.sent.slide,e.onAction&&e.onAction({entity:"Asset",type:"edit",id:e.assetId,contentTypeId:"",slide:n});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=function(){e.onRemove(),e.onAction&&e.onAction({entity:"Asset",type:"delete",id:e.assetId,contentTypeId:""})};return t.useMemo((function(){if("failed"===o){var n=t.createElement(B,{entityType:"Asset",asSquare:"link"!==e.viewType,isDisabled:e.isDisabled,onRemove:u});return e.renderCustomMissingEntityCard?e.renderCustomMissingEntityCard({defaultCard:n,entity:{id:e.assetId,type:"Asset"}}):n}var r=e.getEntityUrl,s=e.sdk,c="big_card"===e.viewType?"default":"small",d={asset:o,entityUrl:r&&r(e.assetId),size:c,isDisabled:e.isDisabled,localeCode:e.sdk.field.locale,defaultLocaleCode:e.sdk.locales.default,renderDragHandle:e.renderDragHandle,onEdit:l,onRemove:u};if("link"===e.viewType)return void 0===o?t.createElement(a.EntryCard,{size:"small",isLoading:!0}):t.createElement(Ue,Object.assign({},d,{href:d.entityUrl,getEntityScheduledActions:s.space.getEntityScheduledActions}));if(void 0===o)return t.createElement(a.AssetCard,{size:c,isLoading:!0});function f(e){var n=E({},d,e,{getEntityScheduledActions:i,asset:(null==e?void 0:e.entity)||d.asset,getAssetUrl:r});return t.createElement(qe,Object.assign({},n))}if(e.renderCustomCard){var y=E({},d,{entity:d.asset}),p=e.renderCustomCard(y,{},f);if(!1!==p)return p}return f()}),[e,c])}function Ve(e){return t.createElement(he,Object.assign({},e,{entityType:"Asset"}),(function(n){var r=n.setValue;return t.createElement(Ge,Object.assign({},e,{viewType:"big_card",assetId:n.entityId,isDisabled:n.isDisabled,onRemove:function(){r(null)}}))}))}Ve.defaultProps={isInitiallyDisabled:!0};var We={gridContainter:r.css({position:"relative",display:"flex",flexWrap:"wrap"}),container:r.css({position:"relative"}),item:r.css({marginBottom:i.spacingM,marginRight:i.spacingM})},Xe=function(e){var t=m.SortableHandle((function(){return e.drag}));return n.createElement(t,null)},Je=m.SortableElement((function(e){return n.createElement("div",{className:We.item},e.children)})),Ke=m.SortableContainer((function(e){return n.createElement("div",{className:"card"===e.viewType?We.gridContainter:We.container},e.items.map((function(t,r){return n.createElement(Je,{disabled:e.isDisabled,key:t.sys.id+"-"+r,index:r},n.createElement(Ge,Object.assign({},e,{sdk:e.sdk,key:t.sys.id+"-"+r,assetId:t.sys.id,onRemove:function(){e.setValue(e.items.filter((function(e,t){return t!==r})))},renderDragHandle:e.isDisabled?void 0:Xe})))})))}));function Qe(e){return t.createElement(Oe,Object.assign({},e,{entityType:"Asset"}),(function(n){return t.createElement(Ke,Object.assign({},e,n,{axis:"card"===e.viewType?"xy":"y",useDragHandle:!0}))}))}Qe.defaultProps={isInitiallyDisabled:!0},exports.AssetThumbnail=re,exports.CombinedLinkActions=function(e){return e.isFull?null:t.createElement("div",{className:"Asset"!==e.entityType||e.isEmpty?b:""},!e.canCreateEntity&&!e.canLinkEntity&&t.createElement(D,null),"Entry"===e.entityType&&t.createElement(N,Object.assign({},e)),"Asset"===e.entityType&&t.createElement(_,Object.assign({},e)))},exports.CreateEntryLinkButton=w,exports.CreateEntryMenuTrigger=T,exports.EntityProvider=le,exports.MissingEntityCard=B,exports.MultipleEntryReferenceEditor=function(e){return t.createElement(Oe,Object.assign({},e,{entityType:"Entry"}),(function(n){return t.createElement(Ne,Object.assign({},e,n,{axis:"y",useDragHandle:!0}))}))},exports.MultipleMediaEditor=Qe,exports.ScheduledIconWithTooltip=ne,exports.SingleEntryReferenceEditor=we,exports.SingleMediaEditor=Ve,exports.WrappedAssetCard=qe,exports.WrappedEntryCard=xe,exports.getScheduleTooltipContent=ee,exports.useEntities=ue;
//# sourceMappingURL=field-editor-reference.cjs.production.min.js.map
